<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A simple utility for migrating data from one RVK environment to another. Notably, this tool can migrate data from an enviroment created with a different backend than the current RKV consumer (e.g from Lmdb to SafeMode)."><title>rkv::migrator - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rkv" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.0 (051478957 2024-07-21)" data-channel="1.80.0" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../rkv/index.html">rkv</a><span class="version">0.19.0</span></h2></div><h2 class="location"><a href="#">Module migrator</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#structs">Structs</a></li></ul></section><h2><a href="../index.html">In crate rkv</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">rkv</a>::<wbr><a class="mod" href="#">migrator</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/rkv/migrator.rs.html#11-179">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A simple utility for migrating data from one RVK environment to another. Notably, this
tool can migrate data from an enviroment created with a different backend than the
current RKV consumer (e.g from Lmdb to SafeMode).</p>
<p>The utility doesn’t support migrating between 32-bit and 64-bit LMDB environments yet,
see <code>arch_migrator</code> if this is needed. However, this utility is ultimately intended to
handle all possible migrations.</p>
<p>The destination environment should be empty of data, otherwise an error is returned.</p>
<p>There are 3 versions of the migration methods:</p>
<ul>
<li><code>migrate_&lt;src&gt;_to_&lt;dst&gt;</code>, where <code>&lt;src&gt;</code> and <code>&lt;dst&gt;</code> are the source and destination
environment types. You’re responsive with opening both these environments, handling
all errors, and performing any cleanup if necessary.</li>
<li><code>open_and_migrate_&lt;src&gt;_to_&lt;dst&gt;</code>, which is similar the the above, but automatically
attempts to open the source environment and delete all of its supporting files if
there’s no other environment open at that path. You’re still responsible with
handling all errors.</li>
<li><code>easy_migrate_&lt;src&gt;_to_&lt;dst&gt;</code> which is similar to the above, but ignores the
migration and doesn’t delete any files if the source environment is invalid
(corrupted), unavailable (path not accessible or incompatible with configuration),
or empty (database has no records).</li>
</ul>
<p>The tool currently has these limitations:</p>
<ol>
<li>It doesn’t support migration from environments created with
<code>EnvironmentFlags::NO_SUB_DIR</code>. To migrate such an environment, create a temporary
directory, copy the environment’s data files in the temporary directory, then
migrate the temporary directory as the source environment.</li>
<li>It doesn’t support migration from databases created with DatabaseFlags::DUP_SORT<code>(with or without</code>DatabaseFlags::DUP_FIXED<code>) nor with </code>DatabaseFlags::INTEGER_KEY<code>. This effectively means that migration is limited to </code>SingleStore`s.</li>
<li>It doesn’t allow for existing data in the destination environment, which means that
it cannot overwrite nor append data.</li>
</ol>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.LmdbArchMigrateError"><code>pub use crate::backend::<a class="enum" href="../backend/enum.LmdbArchMigrateError.html" title="enum rkv::backend::LmdbArchMigrateError">LmdbArchMigrateError</a>;</code></div></li><li><div class="item-name" id="reexport.LmdbArchMigrateResult"><code>pub use crate::backend::<a class="type" href="../backend/type.LmdbArchMigrateResult.html" title="type rkv::backend::LmdbArchMigrateResult">LmdbArchMigrateResult</a>;</code></div></li><li><div class="item-name" id="reexport.LmdbArchMigrator"><code>pub use crate::backend::<a class="struct" href="../backend/struct.LmdbArchMigrator.html" title="struct rkv::backend::LmdbArchMigrator">LmdbArchMigrator</a>;</code></div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Migrator.html" title="struct rkv::migrator::Migrator">Migrator</a></div></li></ul></section></div></main></body></html>